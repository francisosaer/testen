<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Opmeting</title>

<style>
body {
  font-family: Arial, sans-serif;
  font-size: 20px;
  margin: 0;
  padding: 1rem;
  background: #f4f4f4;
}

header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

header img { height: 50px; }

button {
  font-size: 20px;
  padding: 10px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

.btn-add {
  background: #2ecc71;
  color: white;
  width: 100%;
  margin-bottom: 1rem;
}

.element {
  background: white;
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
}

.element-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
  font-size: 22px;
  margin-bottom: .5rem;
}

.remove {
  background: red;
  color: white;
  width: 36px;
  height: 36px;
  border-radius: 6px;
  font-size: 22px;
}

.inputs {
  display: flex;
  gap: .5rem;
  margin-top: .5rem;
  flex-wrap: wrap;
}

.inputs select,
.inputs input {
  font-size: 20px;
  flex: 1;
  padding: .4rem;
}

.photos {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
  margin-top: .5rem;
}

.photo-box {
  position: relative;
}

.photo-box img {
  width: 130px;
  border-radius: 8px;
}

.photo-box button {
  position: absolute;
  top: 4px;
  right: 4px;
  background: red;
  color: white;
  width: 26px;
  height: 26px;
  border-radius: 4px;
  font-size: 18px;
}

.camera-label {
  display: inline-block;
  margin-top: .5rem;
  font-size: 36px;
  background: #ddd;
  padding: 8px 14px;
  border-radius: 8px;
  cursor: pointer;
}

.btn-new-project {
  background: green;
  color: white;
  font-size: 20px;
  width: 100%;
  margin-top: 10px;
  padding: 12px;
  border-radius: 8px;
}
</style>
</head>

<body>

<header>
  <img src="Logordb.png">
  <h2>Opmeting</h2>
</header>

<button class="btn-add" onclick="addElement()">âž• Element toevoegen</button>
<div id="elements"></div>

<button class="btn-new-project" onclick="newProject()">âž• Nieuw project</button>

<script>
let data = JSON.parse(localStorage.getItem("opmeting")) || [];
const elementsDiv = document.getElementById("elements");

function save() {
  localStorage.setItem("opmeting", JSON.stringify(data));
}

function addElement(type = "Raam") {
  data.push({ type, breedte: "", hoogte: "", photos: [] });
  save();
  render();
  setTimeout(() => {
    elementsDiv.lastElementChild.scrollIntoView({ behavior: "smooth" });
  }, 100);
}

function removeElement(i) {
  data.splice(i, 1);
  save();
  render();
}

function handlePhoto(i, input) {
  if (!input.files || !input.files[0]) return;
  const reader = new FileReader();
  reader.onload = () => {
    data[i].photos.push(reader.result);
    save();
    render();
  };
  reader.readAsDataURL(input.files[0]);
}

function removePhoto(i, p) {
  data[i].photos.splice(p, 1);
  save();
  render();
}

function newProject() {
  if (confirm("Weet je zeker dat je een nieuw project wilt starten? Alles wordt gewist.")) {
    data = [];
    localStorage.removeItem("opmeting");
    render();
  }
}

function render() {
  elementsDiv.innerHTML = "";
  const count = { Raam: 0, Deur: 0, Poort: 0 };

  data.forEach((el, i) => {
    count[el.type]++;
    const div = document.createElement("div");
    div.className = "element";

    div.innerHTML = `
      <div class="element-header">
        ${el.type} ${count[el.type]}
        <button class="remove" onclick="removeElement(${i})">âœ–</button>
      </div>

      <div class="inputs">
        <select onchange="data[${i}].type=this.value; save(); render();">
          <option ${el.type==="Raam"?"selected":""}>Raam</option>
          <option ${el.type==="Deur"?"selected":""}>Deur</option>
          <option ${el.type==="Poort"?"selected":""}>Poort</option>
        </select>

        <input placeholder="Breedte (cm)" value="${el.breedte}"
          onchange="data[${i}].breedte=this.value; save();">

        <input placeholder="Hoogte (cm)" value="${el.hoogte}"
          onchange="data[${i}].hoogte=this.value; save();">
      </div>

      <div class="photos"></div>

      <label class="camera-label">
        ðŸ“·
        <input type="file" accept="image/*" style="display:none"
               onchange="handlePhoto(${i}, this)">
      </label>
    `;

    elementsDiv.appendChild(div);

    const photos = div.querySelector(".photos");
    el.photos.forEach((p, pi) => {
      const box = document.createElement("div");
      box.className = "photo-box";
      box.innerHTML = `
        <img src="${p}">
        <button onclick="removePhoto(${i},${pi})">âœ–</button>
      `;
      photos.appendChild(box);
    });
  });
}

render();
</script>

</body>
</html>


